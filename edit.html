<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8" />
  <title>Edit Resume</title>

  <!-- Foundation CSS framework (Bootstrap and jQueryUI also supported) -->
  <link href="css/bootstrap.min.css" rel="stylesheet">
  <!-- Font Awesome icons (Bootstrap, Foundation, and jQueryUI also supported) -->
  <link href="font-awesome/css/font-awesome.min.css" rel="stylesheet" type="text/css">

  <script src="js/jsoneditor.js"></script>

</head>

<body>
  <div class="container">

    <div class='row'>
      <div class='col-lg-6'>
        <div id='editor_holder' class='col-lg-12'></div>
      </div>
      <div class='col-lg-6'>
        <h2>JSON Output</h2>
        <button id='submit' class='btn btn-primary btn-xs'>Submit</button>
        <span id='valid_indicator' class='label label-primary'></span>
        <textarea id='output' style='width: 100%; height: 800px; font-family: monospace;' class='form-control'></textarea>

      </div>
    </div>

  </div>

  <script>
    var $output = document.getElementById('output');
    var $submit = document.getElementById('submit');

    var editor = initializeEditor();

    // Hook up the submit button to log to the console
    $submit.addEventListener('click', function() {
      console.log(editor.getValue());
      editor.setValue(JSON.parse($output.value));
    });

    // status whenever the editor changes
    editor.on('change', function() {
      var json = editor.getValue();
      $output.value = JSON.stringify(json, null, 2);

      // Get an array of errors from the validator
      var errors = editor.validate();
      var indicator = document.getElementById('valid_indicator');

      // Not valid
      if (errors.length) {
        indicator.className = 'label label-danger';
        indicator.textContent = 'Not valid';
      }
      // Valid
      else {
        indicator.className = 'label label-success';
        indicator.textContent = 'valid';
      }
    });

    function initializeEditor() {
      return new JSONEditor(document.getElementById('editor_holder'), {
        ajax: true,
        disable_properties: true,
        disable_edit_json: true,
        theme: "bootstrap3",
        iconlib: "fontawesome4",
        schema: {
          $ref: "resume.json",
          format: "grid"
        },
      });
    }
  </script>


</body>
</html>
